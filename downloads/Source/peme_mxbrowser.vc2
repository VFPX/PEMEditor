*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.20" SourceFile="peme_mxbrowser.vcx" CPID="1252" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS peme_frmbrowser AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Mxbrowser1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: writehtml
	*</DefinedPropArrayMethod>

	*<PropValue>
		Caption = "Form"
		Desktop = .T.
		DoCreate = .T.
		Name = "peme_frmbrowser"
		Visible = .T.
	*</PropValue>

	ADD OBJECT 'Mxbrowser1' AS peme_mxbrowser WITH ;
		Height = 250, ;
		Left = 0, ;
		Name = "Mxbrowser1", ;
		Top = 0, ;
		Width = 376
		*< END OBJECT: ClassLib="peme_mxbrowser.vcx" BaseClass="olecontrol" OLEObject="c:\windows\system32\ieframe.dll" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOBNlX3Ud8sBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAAAAAAAwAAAP7////+////BAAAAP7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9h+VaICjTQEalrAMBP1wWiTAAAANwmAADXGQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAOAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABTAHQAYQB0AAEAAIBCAGEAcgAgAEMAbwBuAHQAcgBvAGwALAAgAHYAZQByAHMAaQBvAG4AIAA1AC4AMAAgACgAUwBQADIAKQABAAAA4NBXAHM1zxGuaQgAKy4SYggAAAAAAAAATAAAAAEUAgAAAAAAwAAAAAAAAEaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB0AGUAbQAzADIAXABDAE8ATQBDAFQATAAzADIALgBPAEMAWAAAAE0AaQBjAHIAbwBzAG8AZgB0ACAAUwBsAGkAZABlAHIAIABDAG8AbgB0AHIAbwBsACwAIAB2AGUAcgBzAGkAbwBuACAANQAuADAAIAAoAFMAUAAyACkACQB7ADMANwAzAEYARgA3AEYAMAAtAEUAQgA4AEIALQAxADEAQwBEAC0AOAA4ADIAMAAtADAAOAAwADAAMgBCADIARgA0AEYANQBBAH0AIABDADoAXABXAA==" />
	
	PROCEDURE Init
		If Version(5) >= 900
			This.mxbrowser1.Anchor = 15
		EndIf 
		
	ENDPROC

	PROCEDURE writehtml
		Lparameters lcHTML
		
		This.mxbrowser1.write (lcHTML)
	ENDPROC

ENDDEFINE

DEFINE CLASS peme_mxbrowser AS olecontrol 
 	*< CLASSDATA: Baseclass="olecontrol" Timestamp="" Scale="Pixels" Uniqueid="" Nombre="peme_mxbrowser" Parent="" ObjName="peme_mxbrowser" OLEObject="C:\WINDOWS\system32\ieframe.dll" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACDiRTDFd8sBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAAAAAAAwAAAP7////+////BAAAAP7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9h+VaICjTQEalrAMBP1wWiTAAAAFYKAABWCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAOAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABTAHQAYQB0AAEAAIBCAGEAcgAgAEMAbwBuAHQAcgBvAGwALAAgAHYAZQByAHMAaQBvAG4AIAA1AC4AMAAgACgAUwBQADIAKQABAAAA4NBXAHM1zxGuaQgAKy4SYggAAAAAAAAATAAAAAEUAgAAAAAAwAAAAAAAAEaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB0AGUAbQAzADIAXABDAE8ATQBDAFQATAAzADIALgBPAEMAWAAAAE0AaQBjAHIAbwBzAG8AZgB0ACAAUwBsAGkAZABlAHIAIABDAG8AbgB0AHIAbwBsACwAIAB2AGUAcgBzAGkAbwBuACAANQAuADAAIAAoAFMAUAAyACkACQB7ADMANwAzAEYARgA3AEYAMAAtAEUAQgA4AEIALQAxADEAQwBEAC0AOAA4ADIAMAAtADAAOAAwADAAMgBCADIARgA0AEYANQBBAH0AIABDADoAXABXAA==" />

	*<DefinedPropArrayMethod>
		*m: write
	*</DefinedPropArrayMethod>

	*<PropValue>
		Height = 100
		Name = "peme_mxbrowser"
		Width = 100
	*</PropValue>
	
	PROCEDURE BeforeNavigate2
		*** ActiveX Control Event ***
		LPARAMETERS pdisp, url, flags, targetframename, postdata, headers, cancel
		
		IF url = "vfps://"
		   Cancel = .T.
		   LOCAL lcMode
		   url = SUBSTR(url,8)
		   lcMode = LOWER(LEFT(url,AT("\",url)-1))
		   MESSAGEBOX("Command: "+lcMode)
		*!*      DO CASE
		*!*         CASE lcMode = "key"
		*!*            THISFORM.GoToKey(Subs(url,5),.T.)
		*!*         CASE lcMode = "name"
		*!*            THISFORM.GoToName(Subs(url,6),.T.)
		*!*         CASE lcMode = "register"
		*!*            THISFORM.RegisterControl(Subs(url,10))
		*!*         OTHERWISE
		*!*            ?? Chr(7)
		*!*      ENDCASE
		ENDIF
		
		IF url="file:" OR SUBSTR(url,2,2)=":\"
		   Cancel = .T.
		   DECLARE INTEGER ShellExecute ;
		      IN SHELL32.DLL ;
		      INTEGER nWinHandle,;
		      STRING cOperation,;   
		      STRING cFileName,;
		      STRING cParameters,;
		      STRING cDirectory,;
		      INTEGER nShowWindow
		   ShellExecute(0,"Open",URL,"","",1)
		ENDIF
	ENDPROC

	PROCEDURE Init
		This.Navigate2("about:blank")
	ENDPROC

	PROCEDURE Refresh
		*** ActiveX Control Method ***
		NODEFAULT
	ENDPROC

	PROCEDURE write
		LPARAMETERS lcHTML
		
		lcHTML = Strt(lcHTML,CHR(0),"")
		IF NOT "<body " $ LOWER(lcHTML)
		   LOCAL lcBGColor
		   lcBGColor = Right(Transform(THISFORM.BackColor,"@0"),6)
		   lcBGColor = [#] + SUBSTR(lcBGColor,5,2) + SUBSTR(lcBGColor,3,2) + SUBSTR(lcBGColor,1,2)
		   LOCAL lcScript
		   
		   TEXT TO lcScript NOSHOW TEXTMERGE
		   <SCRIPT ID=clientEventHandlersJS LANGUAGE=javascript>
		   function document_oncontextmenu() {}
		   </SCRIPT>
		   <SCRIPT LANGUAGE=javascript FOR=document EVENT=oncontextmenu>
		   document_oncontextmenu()
		   </SCRIPT>
		   ENDTEXT
		
		** <body xscroll="auto"  oncontextmenu="return false;">
		
		
		   TEXT TO lcHTML NOSHOW TEXTMERGE
		<html>
		<head>
		<<lcScript>>
		<style>
		body {
		   font-size:<<TRANSFORM(Int(THISFORM.FontSize*1.25))>>px;
		   font-family:<<THISFORM.FontName>>;
		   font-style:normal;
		   xbackground-color:<<lcBGColor>>;
		}
		</style>
		</head>
		<body xscroll="auto" oncontextmenu="return false;">
		<<lcHTML>>
		</body>
		</html>
		   ENDTEXT
		ENDIF
		
		DO WHILE NOT VARTYPE(THIS.Document) = "O"
		ENDDO
		
		THIS.Document.Open()
		THIS.Document.Write(lcHTML)
		THIS.Document.Close()
		
		*!*THIS.Document.body.bgcolor = "silver"
		THIS.Document.body.topmargin = 1
		THIS.Document.body.leftmargin = 3
		
		RETURN .T.
		
	ENDPROC

ENDDEFINE
